<ion-header>
  <typeahead *ngIf="searchInterfaceOpen"
             (closeSearchInterfaceEmitter)="closeSearchInterface($event)"
             (getPartnersWithSearchTermEmitter)="getPartnersWithSearchTerm($event)"
             (toggleMapAndListEmitter)="toggleMapAndList()"
             [mapIcon]='activeFilterFromMenu == "OFFLINEPARTNER"'>
  </typeahead>

  <div class="standard-header" *ngIf="!searchInterfaceOpen">
    <ion-navbar primary>
      <ion-buttons left>
        <button menuToggle *ngIf="!searchInterfaceOpen">
          <ion-icon name="menu" color="grey" class="menu-button-header"></ion-icon>
        </button>
      </ion-buttons>
      <ion-title *ngIf="!searchInterfaceOpen">
        {{title}}
      </ion-title>
      <input id="mySearchInputField"
             placeholder="Geben Sie einen Suchbegriff ein"
             (keyup)="inputToSuggestions($event)"
             [(ngModel)]="searchTerm"
             *ngIf="searchInterfaceOpen">
      <ion-buttons end>
        <button (click)="searchInterfaceOpen = true">
          <ion-icon name="search" color="grey" class="search-button-header"></ion-icon>
        </button>
      </ion-buttons>
      <ion-buttons end *ngIf="showOfflinePartners">
        <button (click)="toggleMapAndList()" class="mapIcon">
          <div class = "toggleListAndMapIcon" [class.mapIcon] = "!showMap"></div>
        </button>
      </ion-buttons>
    </ion-navbar>
  </div>


</ion-header>


<ion-content>

  <div class="wrapper-div">

    <div class="filter-wrapper">
      <ion-row *ngIf="!showMap" class="filter-button-row" [class.dropdownOpen] = "showDropdown[2]">
        <ion-col tappable class="filter-button left-button" (click)="toggleVisibilityDropdowns(0)" >
          <div class="filter-button-text" [class.notActive]="showDropdown[1]">FILTER
            <ion-icon name="arrow-dropdown" [class.singleButton] = "showMap"></ion-icon>
          </div>
        </ion-col>
        <ion-col tappable class="filter-button" (click)="toggleVisibilityDropdowns(1)">
          <div class="filter-button-text" [class.notActive]="showDropdown[0]">SORTIEREN
            <ion-icon name="arrow-dropdown"></ion-icon>
          </div>
        </ion-col>
      </ion-row>

      <ion-row class="filter-button-row" *ngIf="showMap" [class.dropdownOpen] = "showDropdown[2]">
        <ion-col tappable class="filter-button left-button singleButton" (click)="toggleVisibilityDropdowns(0)">
          <div class="filter-button-text" [class.notActive]="showDropdown[1]">FILTER<ion-icon name="arrow-dropdown"></ion-icon>
          </div>
        </ion-col>
      </ion-row>


      <div class="filter-dropdown" *ngIf="showDropdown[1]">
        <div class="filterBy">A - Z</div>
        <div tappable class="filterBy" (click)="showPartner(partner)">Z - A</div>
      </div>

      <div class="filter-menu" *ngIf="showDropdown[0]">
        <ion-row class="currentLocation" *ngIf="offlinePartnerPageComponent || searchPageComponent">
          <ion-col class = "currentPosition" *ngIf="getLocationFromGPSEnabled">
            Aktueller Standort
          </ion-col>
          <ion-col class = "currentPosition" *ngIf="!getLocationFromGPSEnabled" (click)="chooseLocationManually()">
            <p class="cityName">{{cityName}}</p>
            <p class="changeLocation">Ort Ã¤ndern</p>
          </ion-col>
          <ion-col tappable class="map-icon" (click)="toggleGetLocationFromGPSEnabled()">
            <div [class.manually] = "!getLocationFromGPSEnabled"></div>
          </ion-col>
        </ion-row>

        <ion-row tappable class="toggle offline-partner-toggle" (click)="showOfflinePartners = !showOfflinePartners" *ngIf="searchPageComponent">
          <ion-col class="toggle-text">Vor-Ort Partner</ion-col>
          <ion-col class="toggle">
            <ion-toggle [(ngModel)]="showOfflinePartners" color = "light-blue" mode = "ios" [class.checked]="showOnlyPartnersWithCampaign"></ion-toggle>
          </ion-col>
        </ion-row>

        <ion-row tappable class="toggle online-partner-toggle" (click) ="showOnlinePartners = !showOnlinePartners" *ngIf="searchPageComponent">
          <ion-col class="toggle-text">Online Partner</ion-col>
          <ion-col class="toggle">
            <ion-toggle color = "light-blue" [(ngModel)]="showOnlinePartners" mode = "ios" [class.checked]="showOnlyPartnersWithCampaign"></ion-toggle>
          </ion-col>
        </ion-row>

        <ion-row tappable class="toggle has-campaign-partner-toggle" (click)="showOnlyPartnersWithCampaign = !showOnlyPartnersWithCampaign" [class.biggerMarginTop] = "onlinePartnerPageComponent">
          <ion-col class="toggle-text">Nur Partner mit Aktionen</ion-col>
          <ion-col class="toggle">
            <ion-toggle color = "light-blue" mode = "ios" [(ngModel)] = "showOnlyPartnersWithCampaign"></ion-toggle>
          </ion-col>
        </ion-row>

        <div class="showSelectionWrapper">
          <button class="showSelection" ion-button color="primary" (click)="filterButtonPushed()">Auswahl anzeigen</button>
        </div>
      </div>
    </div>

    <div class="initialSpinner" *ngIf="waitingForResults">
      <ion-spinner tappable class="initialSpinner" (click)="hideDropdown()"></ion-spinner>
    </div>

    <div style="height: 8vh"></div>

    <div tappable class="partner-table-wrapper" (click)="hideDropdown()" *ngIf="!showMap">
      <partner-table [partners]="displayedPartners"></partner-table>
    </div>

    <div *ngIf="!showMap">
      <ion-infinite-scroll (ionInfinite)="doInfinite($event)" *ngIf="moreDataCanBeLoaded">
        <ion-infinite-scroll-content>
          <ion-spinner class="initialSpinner"></ion-spinner>
        </ion-infinite-scroll-content>
      </ion-infinite-scroll>
    </div>



    <partner-map [partners]="displayedPartners" *ngIf="showMap" (scrollToTop)="myScrollToTop($event)"></partner-map>

  </div>
</ion-content>

