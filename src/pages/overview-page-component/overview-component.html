<ion-header *ngIf="searchInterfaceOpen">
  <typeahead (getPartnersWithSearchTermEmitter)="loadPartnerPage($event)"
             (closeSearchInterfaceEmitter)="searchInterfaceOpen = false"></typeahead>
</ion-header>

<ion-header *ngIf="!searchInterfaceOpen">
  <ion-navbar primary>
    <ion-buttons left>
      <button menuToggle>
        <ion-icon name="menu" color="grey" class="menu-button-header"></ion-icon>
      </button>
    </ion-buttons>
    <ion-title>
      {{title}}
    </ion-title>
    <ion-buttons end>
      <button (click)="searchInterfaceOpen = true">
        <ion-icon name="ios-search-outline" color="grey" class="search-button-header"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content>
  <div class="bars" *ngIf="userLoggedIn && balance && bonusThisYear" tappable (click) = "navigateToBonusOverview()">
    <ion-row>
      <ion-col>
        <div class="buffer" [style.height]="heightBlueBarRedBar()[2]"></div>
        <p>{{balance| currency:'EUR':true:'1.2-2'}}</p>
        <div class="blue bar" [style.height]="heightBlueBarRedBar()[0]"></div>
      </ion-col>
      <ion-col>
        <div class="buffer" [style.height]="heightBlueBarRedBar()[3]"></div>
        <p>{{bonusThisYear | currency:'EUR':true:'1.2-2'}}</p>
        <div class="red bar" [style.height]="heightBlueBarRedBar()[1]"></div>
      </ion-col>
    </ion-row>
  </div>

  <div class="moneyDetailsAccount" *ngIf="userLoggedIn && balance && bonusThisYear" tappable (click) = "navigateToBonusOverview()">

    <ion-row class="money-detail-row balance-row">
      <ion-col class="icon-col">
        <div class="piggyBank icon"></div>
      </ion-col>
      <ion-col class="text-col">
        <div class="text-div">
          Dieses Jahr mit BSW gespart
        </div>
      </ion-col>
      <ion-col class="bonus-col">
        <p>{{balance| currency:'EUR':true:'1.2-2'}}</p>
      </ion-col>
    </ion-row>

    <ion-row class="money-detail-row summary-row">
      <ion-col class="icon-col">
        <div class="coins icon"></div>
      </ion-col>
      <ion-col class="text-col">
        <div class="text-div">
          Aktueller Stand Bonuskonto
        </div>
      </ion-col>
      <ion-col class="bonus-col">
        <p>{{bonusThisYear | currency:'EUR':true:'1.2-2'}}</p>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col class="footer-col" *ngIf="bonusDataFromCache">
        Die verwendeten Daten stammen aus einer früheren Sitzung und sind möglicherweise veraltet. Stellen Sie eine Internetverbindung her um die Daten zu aktualisieren.
      </ion-col>
    </ion-row>

  </div>

  <div class="initialSpinner" *ngIf="waitingForResults && favoritePartners.length == 0 && lastVisitedPartners.length == 0 && !noDataToDisplay">
    <ion-spinner class="initialSpinner"></ion-spinner>
  </div>
  <ion-item *ngIf="waitingForResults && noDataToDisplay" text-wrap>
    Wir können Ihnen leider derzeit keine Daten anzeigen. Bitte verbinden Sie sich mit dem Internet.
  </ion-item>

  <ion-row class="title-row" *ngIf="favoritePartners.length" (click)="loadUserSpecificPartnerTable('favorites')" tappable>
    <ion-col class="title">
      <p class="title-paragraph">Favoriten</p>
    </ion-col>
    <ion-col class="more" *ngIf="moreThanFiveFavorites">
      <button ion-button icon-only tappable class="more">...
      </button>
    </ion-col>
  </ion-row>

  <partner-table [partners]="firstFiveFavorites"
                 (showPartnerEventEmitter)="showPartner($event)"
                 *ngIf="favoritePartners && !favoritesFromCache"></partner-table>
  <partner-table-cached [partners]="firstFiveFavorites"
                        (showCachedPartnerEventEmitter)="showCachedPartner($event)"
                        *ngIf="favoritePartners && favoritesFromCache">
  </partner-table-cached>

  <ion-row class="title-row" *ngIf="lastVisitedPartners.length" (click)="loadUserSpecificPartnerTable('lastvisitedPartners')" tappable>
    <ion-col col-auto class="title">
      <p class="title-paragraph">Zuletzt besuchte Partner</p>
    </ion-col>
    <ion-col class="more" *ngIf="moreThanFiveLastVisitedPartners">
      <button ion-button icon-only tappable class="more">
        ...
      </button>
    </ion-col>
  </ion-row>

  <partner-table [partners]="lastVisitedFive"
                 (showPartnerEventEmitter)="showPartner($event)"
                 *ngIf="lastVisitedPartners && !lastVisitedFromCache"></partner-table>

  <partner-table-cached [partners]="lastVisitedFive"
                 (showCachedPartnerEventEmitter)="showCachedPartner($event)"
                 *ngIf="lastVisitedPartners && lastVisitedFromCache"></partner-table-cached>

  <ion-row class="title-row" *ngIf="offlinePartners" (click)="showOfflinePartners()" tappable>
    <ion-col class="title">
      <p class="title-paragraph">Vor Ort Partner</p>
    </ion-col>
    <ion-col class="more">
      <button ion-button icon-only tappable class="more">...</button>
    </ion-col>
  </ion-row>
  <partner-table [partners]="offlinePartners"
                 (showPartnerEventEmitter)="showPartner($event)"
                 *ngIf="offlinePartners"></partner-table>

  <ion-row class="title-row" *ngIf="onlinePartners" (click)="showOnlinePartners()" tappable>
    <ion-col class="title">
      <p class="title-paragraph">Online Partner</p>
    </ion-col>
    <ion-col class="more">
      <button ion-button icon-only tappable class="more">...</button>
    </ion-col>
  </ion-row>
  <partner-table [partners]="onlinePartners"
                 (showPartnerEventEmitter)="showPartner($event)"
                 *ngIf="onlinePartners"></partner-table>

</ion-content>

